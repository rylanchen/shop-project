# 开发踩坑记录（随手记）

1. **骨架屏闪烁**  
   列表页切换搜索条件时，二次请求太快导致闪烁。先加了 200~600ms 抖动模拟网络，体感好一些。后续再考虑请求合并。

2. **路由守卫时机**  
   直接在组件里判断登录会有闪一下的问题，最后放在页面入口判断（见 `Cart.jsx`），并保留 redirect。够用了。

3. **收藏状态不同步**  
   起初收藏放在组件局部 state，切到详情页又不同步，后来统一到 zustand，并持久化。

4. **图片加载慢**  
   先用 `loading="lazy"`，再加一个轻微淡入。CDN 不稳定时，fallback 到本地占位图。

5. **分页边界**  
   当最后一页删到没数据时，页码回退一页。这里先手搓，后面再抽成 hook 吧。 // FIXME: 这一坨逻辑还可以更优雅
